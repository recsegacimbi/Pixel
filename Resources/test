@echo off
chcp 65001
setlocal enabledelayedexpansion >nul
cls

net session >nul 2>&1
if %errorlevel% neq 0 (
    call :logo
    echo please run it as an administrator
    echo.
    echo press enter to leave
    pause >nul
    exit
)

timeout /t 1 /nobreak >nul
call :logo
set /p choice=Do you want to create a System Restore Point? (y/n): 
if /i "%choice%"=="y" (
    PowerShell -Command "Checkpoint-Computer -Description 'Pixel restore point' -RestorePointType 'MODIFY_SETTINGS'"
    echo Restore Point created.
) else (
    echo Operation canceled.
)
timeout /t 1 >nul

color C
call :logo
echo discord: mateeight, if u have any error report to me please
echo this script is full copy from OneClick, Melody, Platinum Optimizer
echo if u press enter u start the tweak
pause


call :logo
echo Installing Redists...
timeout /t 5 >nul
cls

call :logo
echo Installing Visual C++
echo.
echo Press OK on any popups
timeout /t 1 >nul

powershell -Command "Invoke-WebRequest 'https://github.com/abbodi1406/vcredist/releases/download/v0.79.0/VisualCppRedist_AIO_x86_x64.exe' -OutFile '%temp%\VisualCppRedist_AIO_x86_x64.exe'" >nul 2>&1

if not exist "%temp%\VisualCppRedist_AIO_x86_x64.exe" (
    echo Error: Failed to download Visual C++ redistributable package.
    pause
    exit /b
)

"%temp%\VisualCppRedist_AIO_x86_x64.exe" /aiA /gm2
del /f /q "%temp%\VisualCppRedist_AIO_x86_x64.exe"
cls

call :logo
echo Installing DirectX...
timeout /t 2 >nul

curl -L -o "%temp%\dxwebsetup.exe" "https://download.microsoft.com/download/1/7/1/1718CCC4-6315-4D8E-9543-8E28A4E18C4C/dxwebsetup.exe"
start /wait "%temp%\dxwebsetup.exe" /Q
del /f /q "%temp%\dxwebsetup.exe"
cls

call :logo
echo Making update framework to start on next boot...
timeout /t 5 >nul

(
echo echo Continuing... updating Framework
echo timeout /t 10
echo cls
echo start /wait "" "C:\Windows\Microsoft.NET\Framework64\v4.0.30319\ngen.exe" update
echo start /wait "" "C:\Windows\Microsoft.NET\Framework\v4.0.30319\ngen.exe" update
echo cd /d C:\Windows\System32
echo dism /online /cleanup-image /startcomponentcleanup /resetbase /defer
echo cls
echo timeout /t 10
echo del "%temp%\ngen_update.bat"
) > "%temp%\ngen_update.bat"

reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce" /v ngenUpdate /t REG_SZ /d "\"%temp%\ngen_update.bat\"" /f
cls

call :logo
echo Installing NetFramework 5 x64...
timeout /t 2 >nul
powershell -Command "Invoke-WebRequest 'https://download.visualstudio.microsoft.com/download/pr/3aa4e942-42cd-4bf5-afe7-fc23bd9c69c5/64da54c8864e473c19a7d3de15790418/windowsdesktop-runtime-5.0.17-win-x64.exe' -OutFile 'C:\windowsdesktop-runtime-5.0.17-win-x64.exe'"
start /wait C:\windowsdesktop-runtime-5.0.17-win-x64.exe /Q
del /f /q C:\windowsdesktop-runtime-5.0.17-win-x64.exe
cls

call :logo
echo Installing NetFramework 5 x86...
timeout /t 2 >nul
powershell -Command "Invoke-WebRequest 'https://download.visualstudio.microsoft.com/download/pr/b6fe5f2a-95f4-46f1-9824-f5994f10bc69/db5ec9b47ec877b5276f83a185fdb6a0/windowsdesktop-runtime-5.0.17-win-x86.exe' -OutFile 'C:\windowsdesktop-runtime-5.0.17-win-x86.exe'"
start /wait C:\windowsdesktop-runtime-5.0.17-win-x86.exe /Q
del /f /q C:\windowsdesktop-runtime-5.0.17-win-x86.exe
cls

call :logo
echo Installing NetFramework 6 x64...
timeout /t 2 >nul
powershell -Command "Invoke-WebRequest 'https://download.visualstudio.microsoft.com/download/pr/3ef3cd0c-8c7f-4146-bd8d-589d748b997e/3477d059f8fe5cceb5166b367d7995c6/windowsdesktop-runtime-6.0.27-win-x64.exe' -OutFile 'C:\windowsdesktop-runtime-6.0.27-win-x64.exe'"
start /wait C:\windowsdesktop-runtime-6.0.27-win-x64.exe /Q
del /f /q C:\windowsdesktop-runtime-6.0.27-win-x64.exe
cls

call :logo
echo Installing NetFramework 6 x86...
timeout /t 2 >nul
powershell -Command "Invoke-WebRequest 'https://download.visualstudio.microsoft.com/download/pr/a9669480-f3e0-42a6-b381-108950dfe290/b54d6613c0fa2839c41d61478926ccb9/windowsdesktop-runtime-6.0.27-win-x86.exe' -OutFile 'C:\windowsdesktop-runtime-6.0.27-win-x86.exe'"
start /wait C:\windowsdesktop-runtime-6.0.27-win-x86.exe /Q
del /f /q C:\windowsdesktop-runtime-6.0.27-win-x86.exe
cls

call :logo
echo Installing NetFramework 7 x64...
timeout /t 2 >nul
powershell -Command "Invoke-WebRequest 'https://download.visualstudio.microsoft.com/download/pr/38c809cc-858d-45ed-88f5-a7f098cab691/2e4f859f8f6cf64aa952df2a80f16d2e/windowsdesktop-runtime-7.0.16-win-x64.exe' -OutFile 'C:\windowsdesktop-runtime-7.0.16-win-x64.exe'"
start /wait C:\windowsdesktop-runtime-7.0.16-win-x64.exe /Q
del /f /q C:\windowsdesktop-runtime-7.0.16-win-x64.exe
cls

call :logo
echo Installing NetFramework 7 x86...
timeout /t 2 >nul
powershell -Command "Invoke-WebRequest 'https://download.visualstudio.microsoft.com/download/pr/ff4b13ba-07aa-4aa7-b5ae-9111c363c802/5fdedee9a9fae645bfdda3a8930c923d/windowsdesktop-runtime-7.0.16-win-x86.exe' -OutFile 'C:\windowsdesktop-runtime-7.0.16-win-x86.exe'"
start /wait C:\windowsdesktop-runtime-7.0.16-win-x86.exe /Q
del /f /q C:\windowsdesktop-runtime-7.0.16-win-x86.exe
cls

call :logo
echo Installing NetFramework 8 x64...
timeout /t 2 >nul
powershell -Command "Invoke-WebRequest 'https://download.visualstudio.microsoft.com/download/pr/84ba33d4-4407-4572-9bfa-414d26e7c67c/bb81f8c9e6c9ee1ca547396f6e71b65f/windowsdesktop-runtime-8.0.2-win-x64.exe' -OutFile 'C:\windowsdesktop-runtime-8.0.2-win-x64.exe'"
start /wait C:\windowsdesktop-runtime-8.0.2-win-x64.exe /Q
del /f /q C:\windowsdesktop-runtime-8.0.2-win-x64.exe
cls

call :logo
echo Installing NetFramework 8 x86...
timeout /t 2 >nul
powershell -Command "Invoke-WebRequest 'https://download.visualstudio.microsoft.com/download/pr/9b77b480-7e32-4321-b417-a41e0f8ea952/3922bbf5538277b1d41e9b49ee443673/windowsdesktop-runtime-8.0.2-win-x86.exe' -OutFile 'C:\windowsdesktop-runtime-8.0.2-win-x86.exe'"
start /wait C:\windowsdesktop-runtime-8.0.2-win-x86.exe /Q
del /f /q C:\windowsdesktop-runtime-8.0.2-win-x86.exe
cls

call :logo
echo Installing XNA...
timeout /t 2 >nul
curl -L -o "%temp%\XNA.msi" "https://download.microsoft.com/download/A/C/2/AC2C903B-E6E8-42C2-9FD7-BEBAC362A930/xnafx40_redist.msi"
msiexec /i "%temp%\XNA.msi" /qn
del /f /q "%temp%\XNA.msi"
cls

call :logo
echo Installing NetFramework 4.8.1...
timeout /t 2 >nul
powershell -Command "Invoke-WebRequest 'https://download.microsoft.com/download/4/b/2/cd00d4ed-ebdd-49ee-8a33-eabc3d1030e3/NDP481-x86-x64-AllOS-ENU.exe' -OutFile 'C:\NDP481-x86-x64-AllOS-ENU.exe'"
start /wait C:\NDP481-x86-x64-AllOS-ENU.exe /Q
del /f /q C:\NDP481-x86-x64-AllOS-ENU.exe
cls

call :logo
echo done the redist install

:Disable_Defender
call :logo
cls
chcp 65001 >nul 2>&1
call :logo
echo Recommended to disable windows defender
echo.
chcp 437 >nul
echo '[Choose an option]'
echo '1. Disable 
echo '2. Keep Enabled
set /p option=
chcp 65001 >nul 2>&1
if "%option%"=="1" (
    echo [%DATE% %TIME%] Windows Defender Options: User Chose "Option 1" - Disable Windows Defender.
    cls
    call :logo
    timeout 2 > nul
    goto :RTP_TPR_Disable     
) else if "%option%"=="2" (
    echo [%DATE% %TIME%] Windows Defender Options: User Chose "Option 2" - Keep Windows Defender Enabled.  
    cls
    call :logo
    echo Defender is still active
    timeout 2 > nul
    goto :skipdefender 
) else (
    cls
    chcp 437 >nul
    Powershell -NoProfile -Command "Write-Host 'Invalid choice, Please choose options 1-3.' -ForegroundColor White -BackgroundColor Red"
    timeout 2 > nul
    cls
    goto :Disable_Defender
)

:: Real Time and Tamper Protection disable. (Guides the user to disable defender related settings)
:RTP_TPR_Disable 
cls
color A
chcp 65001 >nul 2>&1
call :logo
echo. 
echo step 1
echo Virus and Threat Protection
echo.
echo step 2
echo manage settings
echo.
echo step 3
echo turn off all
explorer.exe ms-settings:windowsdefender
echo only press enter when this steps are done!!!!!!!
pause

echo downloading the resources
set "FileURL=https://github.com/recsegacimbi/Pixel/raw/main/Resources/Pixel.zip"
set "FileName=Pixel.zip"
set "ExtractFolder=C:\Pixel"
set "DownloadsFolder=C:\"
curl -s -L "%FileURL%" -o "%DownloadsFolder%\%FileName%"
mkdir "%ExtractFolder%" >nul 2>&1
pushd "%ExtractFolder%" >nul 2>&1
tar -xf "%DownloadsFolder%\%FileName%" --strip-components=1 >nul 2>&1
del /q "C:\Pixel.zip"

start "" "C:\Pixel\Dcontrol\dControl.exe"
echo press disable windows defender press enter to continue
pause













:logo
echo.
echo.
echo.        ██████╗ ██╗██╗  ██╗███████╗██╗     
echo.        ██╔══██╗██║╚██╗██╔╝██╔════╝██║     
echo.        ██████╔╝██║ ╚███╔╝ █████╗  ██║     
echo.        ██╔═══╝ ██║ ██╔██╗ ██╔══╝  ██║     
echo.        ██║     ██║██╔╝ ██╗███████╗███████╗
echo.        ╚═╝     ╚═╝╚═╝  ╚═╝╚══════╝╚══════╝
echo.
echo.
